<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_2.dtd'>
<nta>
	<declaration>clock time;
clock weeks;

bool recovery; //indicates whether a patient is in a recovery state

double paltime; //records the time to enter Protocol.Paliative

broadcast chan test, stop, startrecov, endrecov, g1, g2, g3;
urgent broadcast chan reset;

const int N=6;            //number of toxics
typedef int[0,N-1] id_t;  //identifier type for a toxic

int g[N];            //grade of a toxic
int n[N];           //number of times a toxic has occurred

int notox[N]; //indicates initially if a toxic does NOT occur

int r[N];            //result of a test (grade of a toxic)

int rr[N];        //number of times a toxic has been diagnosed (so resulting in recovery)
int rec[N];       // number of time in recovery for a real positive toxic (not with grade 0)

int cycle; // number of 6-week cycles that have been passed


const int lb[N] = {1,4,13,14,8,1};      //lower bound occurrence toxic in weeks
const int ub[N] = {26,21,43,29,9,2};    //upper bound occurrence toxic in weeks
const int per[N] = {2,2,1,1,2,2};      //growth period occurrence toxic in weeks (1-&gt;2-&gt;3 is 2 periods)

const int p[11][N] = {{96,28,16,12,4,4}, //first parameter: n[id]
//{96,28,16,12,4,4}, {96,28,16,12,4,4}, {96,28,16,12,4,4}, //probability toxic occurrence remains the same
//{96,28,16,12,4,4}, {96,28,16,12,4,4}, {96,28,16,12,4,4}, {96,28,16,12,4,4},
//{96,28,16,12,4,4}, {96,28,16,12,4,4}, {96,28,16,12,4,4}};
{192,56,32,24,8,8}, {288,84,48,36,8,8}, {400,100,60,50,16,16}, //probability toxic occurrence increases 
{400,100,60,50,16,16}, {400,100,60,50,16,16}, {400,100,60,50,16,16}, {400,100,60,50,16,16},
{400,100,60,50,16,16}, {400,100,50,50,16,16}, {400,100,60,50,16,16}};

//const int prog[12] = {300,300,150,125,100,50,25,10,4,1,0,0}; //first two 30%, then halves every next time
//const int prog[12] = {300,300,200,100,50,25,12,6,4,2,1,1};  //another attempt
//const int prog[12] = {344,285,231,181,148,122,94,57,36,30,35,1};  // numbers determined by FvD manual prob calc based on pop at risk 12-3-2020
//const int prog[12] = {321,332,226,265,128,187,33,85,37,19,39,1};  // numbers determined by FvD manual prob calc based on pop at risk 8-5-2020 raw manual
//const int prog[12] = {344,254,231,181,148,122,94,57,36,30,35,1};  // numbers determined by FvD manual prob calc based on pop at risk 8-5-2020 with loess to smooth data
//const int prog[12] = {338,287,239,193,151,114,83,58,41,32,32,1};  // numbers determined by FvD manual prob calc based on pop at risk 8-5-2020 with 3th order poly to smooth data
const int prog[12] = {380,290,220,168,128,97,74,56,43,33,25,1};  // numbers determined by FvD manual prob calc based on pop at risk 8-5-2020 with exponential to smooth data

//const int prog[12] = {0,0,0,0,0,0,0,0,0,0,0,0}; //no progression
// parameter: cycle number

const int c[4][11] = // chance of recovery based on grade (first parameter) and number of times n[id] 
{{10,10,10,10,10,10,10,10,10,10,10}, //the toxic already occurred before 
 {10, 9, 8, 0, 0, 0, 0, 0, 0, 0, 0},
 { 8, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0},
 { 5, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0}};

//const int sens[N] = {60,60,60,60,60,60};
//const int sens[N] = {70,70,70,70,70,70};
//const int sens[N] = {80,80,80,80,80,80};
//const int sens[N] = {85,85,85,85,85,85};
const int sens[N] = {90,90,90,90,90,90};
//const int sens[N] = {100,100,100,100,100,100};
//const int sens[N] = {95,83,65,70,80,80};//estimates by Daan 4/12/18
//const int sens[N] = {68,68,68,68,68,68};

//const int spec[N] = {50,50,50,50,50,50};
//const int spec[N] = {60,60,60,60,60,70};
//const int spec[N] = {70,70,70,70,70,70};
const int spec[N] = {88,88,88,88,88,88};
//const int spec[N] = {90,90,90,90,90,90};
//const int spec[N] = {91,91,91,91,91,91};
//const int spec[N] = {92,92,92,92,92,92};
//const int spec[N] = {93,93,93,93,93,93};
//const int spec[N] = {94,94,94,94,94,94};
//const int spec[N] = {96,96,96,96,96,96};
//const int spec[N] = {98,98,98,98,98,98};
//const int spec[N] = {99,99,99,99,99,99};
//const int spec[N] = {100,100,100,100,100,100}; 
//const int spec[N] = {95,95,95,95,95,95};
//const int spec[N] = {50,84,62,85,80,80};//estimates by Daan 4/12/18

const int lab[4][N] = {{10, 10, 10, 10, 10, 10}, {30, 30, 30, 30, 30, 30}, {50, 50, 50, 50, 50, 50}, {80, 80, 80, 80, 80, 80}};
const int D_tox[4][N] = {{10, 10, 10, 10, 10, 10},{30, 30, 30, 30, 30, 30},{50, 50, 50, 50, 50, 50},{80, 80, 80, 80, 80, 80}};</declaration>
	<template>
		<name>Protocol</name>
		<declaration>
clock period;

bool allvalues0() {
return (r[0]==0 &amp;&amp; r[1]==0 &amp;&amp; r[2]==0 &amp;&amp; r[3]==0 &amp;&amp; r[4]==0 &amp;&amp; r[5]==0);
}

bool somevalue1() {
return ((r[0]==1 || r[1]==1 || r[2]==1 || r[3]==1 || r[4]==1 || r[5]==1) &amp;&amp;
        (r[0]&lt;=1 &amp;&amp; r[1]&lt;=1 &amp;&amp; r[2]&lt;=1 &amp;&amp; r[3]&lt;=1 &amp;&amp; r[4]&lt;=1 &amp;&amp; r[5]&lt;=1));
}

bool somevalue2or3() {
return (r[0]&gt;=2 || r[1]&gt;=2 || r[2]&gt;=2 || r[3]&gt;=2 || r[4]&gt;=2 || r[5]&gt;=2);
}

bool maxtwice() {
//return (rec[0]&lt;=9 &amp;&amp; rec[1]&lt;=9 &amp;&amp; rec[2]&lt;=9 &amp;&amp; rec[3]&lt;=9 &amp;&amp; rec[4]&lt;=9 &amp;&amp; rec[5]&lt;=9);//this means no restriction to e recoveries
return (rr[0]&lt;=2 &amp;&amp; rr[1]&lt;=2 &amp;&amp; rr[2]&lt;=2 &amp;&amp; rr[3]&lt;=2 &amp;&amp; rr[4]&lt;=2 &amp;&amp; rr[5]&lt;=2);
}

bool maxAE() {
return (rr[0] + rr[1] + rr[2] + rr[3] + rr[4] + rr[5] &gt;=6);
}

void resetrr()// to forget toxics that occurred during the first two cycles
{ for (i:int[0,5])
   { rr[i]=0;
    }
}


</declaration>
		<location id="id0" x="-867" y="230">
			<name x="-961" y="230">maxAEcount</name>
			<committed/>
		</location>
		<location id="id1" x="-986" y="51">
			<name x="-1071" y="18">FastRecover</name>
			<label kind="invariant" x="-1071" y="43">period&lt;=2</label>
		</location>
		<location id="id2" x="-298" y="238">
			<committed/>
		</location>
		<location id="id3" x="-799" y="391">
			<name x="-825" y="400">Palliative</name>
		</location>
		<location id="id4" x="-247" y="51">
			<name x="-255" y="18">Recover</name>
			<label kind="invariant" x="-230" y="43">period&lt;=5</label>
		</location>
		<location id="id5" x="-502" y="77">
			<name x="-545" y="69">Wait</name>
			<label kind="invariant" x="-485" y="68">period&lt;=2</label>
		</location>
		<location id="id6" x="-629" y="179">
			<name x="-646" y="144">Check</name>
			<urgent/>
		</location>
		<location id="id7" x="-799" y="289">
			<committed/>
		</location>
		<location id="id8" x="-629" y="-16">
			<committed/>
		</location>
		<location id="id9" x="-629" y="-93">
			<name x="-639" y="-127">Start</name>
			<urgent/>
		</location>
		<branchpoint id="id10" x="-417" y="289">
		</branchpoint>
		<init ref="id9"/>
		<transition>
			<source ref="id0"/>
			<target ref="id3"/>
			<label kind="synchronisation" x="-901" y="289">stop!</label>
			<nail x="-867" y="391"/>
		</transition>
		<transition>
			<source ref="id6"/>
			<target ref="id0"/>
			<label kind="guard" x="-910" y="162">maxAE() &amp;&amp;
!allvalues0() &amp;&amp;
cycle&gt;1</label>
		</transition>
		<transition>
			<source ref="id4"/>
			<target ref="id3"/>
			<label kind="synchronisation" x="-238" y="264">stop?</label>
			<nail x="-247" y="85"/>
			<nail x="-247" y="391"/>
		</transition>
		<transition>
			<source ref="id1"/>
			<target ref="id3"/>
			<label kind="synchronisation" x="-1029" y="264">stop?</label>
			<nail x="-986" y="391"/>
		</transition>
		<transition>
			<source ref="id5"/>
			<target ref="id3"/>
			<label kind="synchronisation" x="-544" y="332">stop?</label>
			<nail x="-502" y="391"/>
		</transition>
		<transition>
			<source ref="id1"/>
			<target ref="id8"/>
			<label kind="guard" x="-935" y="-16">period&gt;=2</label>
			<label kind="synchronisation" x="-859" y="-16">endrecov!</label>
			<label kind="assignment" x="-791" y="-50">period=0,
resetrr(),
recovery=0</label>
		</transition>
		<transition>
			<source ref="id6"/>
			<target ref="id1"/>
			<label kind="guard" x="-850" y="60">!allvalues0() &amp;&amp;
cycle &lt;=1</label>
			<label kind="synchronisation" x="-876" y="119">startrecov!</label>
			<label kind="assignment" x="-935" y="102">recovery=1</label>
		</transition>
		<transition>
			<source ref="id2"/>
			<target ref="id4"/>
			<label kind="synchronisation" x="-349" y="145">startrecov!</label>
			<label kind="assignment" x="-349" y="128">recovery=1</label>
		</transition>
		<transition>
			<source ref="id7"/>
			<target ref="id3"/>
			<label kind="synchronisation" x="-791" y="323">stop!</label>
		</transition>
		<transition>
			<source ref="id10"/>
			<target ref="id7"/>
			<label kind="probability" x="-459" y="289">50</label>
		</transition>
		<transition>
			<source ref="id10"/>
			<target ref="id2"/>
			<label kind="probability" x="-400" y="281">50</label>
		</transition>
		<transition>
			<source ref="id6"/>
			<target ref="id10"/>
			<label kind="guard" x="-493" y="213">somevalue2or3() &amp;&amp;
maxtwice() &amp;&amp; cycle &gt;1</label>
		</transition>
		<transition>
			<source ref="id4"/>
			<target ref="id8"/>
			<label kind="guard" x="-383" y="1">period&gt;=5</label>
			<label kind="synchronisation" x="-468" y="-16">endrecov!</label>
			<label kind="assignment" x="-544" y="-42">period=0,
recovery=0</label>
		</transition>
		<transition>
			<source ref="id6"/>
			<target ref="id4"/>
			<label kind="guard" x="-502" y="136">somevalue1() &amp;&amp;
maxtwice() &amp;&amp; cycle&gt;1</label>
			<label kind="synchronisation" x="-417" y="102">startrecov!</label>
			<label kind="assignment" x="-366" y="85">recovery=1</label>
		</transition>
		<transition>
			<source ref="id6"/>
			<target ref="id7"/>
			<label kind="guard" x="-723" y="238">!maxtwice() &amp;&amp;
!allvalues0() &amp;&amp; cycle &gt;1</label>
		</transition>
		<transition>
			<source ref="id5"/>
			<target ref="id8"/>
			<label kind="guard" x="-536" y="35">period&gt;=2</label>
			<label kind="assignment" x="-561" y="18">period=0</label>
		</transition>
		<transition>
			<source ref="id6"/>
			<target ref="id5"/>
			<label kind="guard" x="-629" y="102">allvalues0()</label>
		</transition>
		<transition>
			<source ref="id8"/>
			<target ref="id6"/>
			<label kind="synchronisation" x="-714" y="68">test!</label>
			<nail x="-731" y="77"/>
		</transition>
		<transition>
			<source ref="id9"/>
			<target ref="id8"/>
		</transition>
	</template>
	<template>
		<name>Patient</name>
		<declaration>clock good; //for recording how long a patient is in certain states


bool maxgrade0(){
return (g[0]==0 &amp;&amp; g[1]==0 &amp;&amp; g[2]==0 &amp;&amp; g[3]==0 &amp;&amp; g[4]==0 &amp;&amp; g[5]==0);
        
}

bool maxgrade1(){
return ((g[0]==1 || g[1]==1 || g[2]==1 || g[3]==1 || g[4]==1 || g[5]==1)&amp;&amp;
        (g[0]&lt;=1 &amp;&amp; g[1]&lt;=1 &amp;&amp; g[2]&lt;=1 &amp;&amp; g[3]&lt;=1 &amp;&amp; g[4]&lt;=1 &amp;&amp; g[5]&lt;=1));
}

bool maxgrade2(){
return ((g[0]==2 || g[1]==2 || g[2]==2 || g[3]==2 || g[4]==2 || g[5]==2)&amp;&amp;
        (g[0]&lt;=2 &amp;&amp; g[1]&lt;=2 &amp;&amp; g[2]&lt;=2 &amp;&amp; g[3]&lt;=2 &amp;&amp; g[4]&lt;=2 &amp;&amp; g[5]&lt;=2));
}

bool maxgrade3(){
return ((g[0]==3 || g[1]==3 || g[2]==3 || g[3]==3 || g[4]==3 || g[5]==3)&amp;&amp;
        (g[0]&lt;=3 &amp;&amp; g[1]&lt;=3 &amp;&amp; g[2]&lt;=3 &amp;&amp; g[3]&lt;=3 &amp;&amp; g[4]&lt;=3 &amp;&amp; g[5]&lt;=3));
}
</declaration>
		<location id="id11" x="-229" y="195">
			<name x="-297" y="161">Palliative3</name>
			<label kind="invariant" x="-237" y="212">good'==0</label>
		</location>
		<location id="id12" x="-229" y="85">
			<name x="-288" y="52">Palliative2</name>
			<label kind="invariant" x="-239" y="102">good'==0</label>
		</location>
		<location id="id13" x="-229" y="-34">
			<name x="-289" y="-68">Palliative1</name>
			<label kind="invariant" x="-238" y="-17">good'==0</label>
		</location>
		<location id="id14" x="-221" y="-170">
			<name x="-255" y="-204">Palliative0</name>
			<label kind="invariant" x="-264" y="-161">good'==1</label>
		</location>
		<location id="id15" x="-59" y="263">
			<name x="-42" y="255">Problem</name>
			<label kind="invariant" x="-51" y="272">good'==0</label>
		</location>
		<location id="id16" x="280" y="-34">
			<name x="297" y="-42">Rec1</name>
			<label kind="invariant" x="272" y="-25">good'==0</label>
		</location>
		<location id="id17" x="-17" y="195">
			<name x="-8" y="170">G3_and_4</name>
			<label kind="invariant" x="-25" y="204">good'==0</label>
			<label kind="exponentialrate" x="-25" y="221">1:3</label>
		</location>
		<location id="id18" x="-17" y="85">
			<name x="-8" y="59">G2</name>
			<label kind="invariant" x="-85" y="93">good'==0</label>
		</location>
		<location id="id19" x="-17" y="-34">
			<name x="-8" y="-68">G1</name>
			<label kind="invariant" x="-85" y="-25">good'==0</label>
		</location>
		<location id="id20" x="51" y="-280">
			<name x="43" y="-314">Rec0</name>
			<label kind="invariant" x="42" y="-262">good'==1</label>
		</location>
		<location id="id21" x="-17" y="-170">
			<name x="0" y="-195">G0</name>
			<label kind="invariant" x="-76" y="-161">good'==1</label>
		</location>
		<location id="id22" x="-170" y="-272">
			<label kind="invariant" x="-180" y="-255">good'==0</label>
			<urgent/>
		</location>
		<location id="id23" x="535" y="93">
			<name x="552" y="85">Rec2</name>
			<label kind="invariant" x="527" y="102">good'==0</label>
		</location>
		<location id="id24" x="595" y="204">
			<name x="612" y="195">Rec3</name>
			<label kind="invariant" x="586" y="212">good'==0</label>
		</location>
		<init ref="id22"/>
		<transition>
			<source ref="id20"/>
			<target ref="id16"/>
			<label kind="synchronisation" x="289" y="-229">g1?</label>
			<nail x="280" y="-280"/>
		</transition>
		<transition>
			<source ref="id24"/>
			<target ref="id19"/>
			<label kind="guard" x="416" y="119">maxgrade1()</label>
			<label kind="synchronisation" x="467" y="136">endrecov?</label>
		</transition>
		<transition>
			<source ref="id24"/>
			<target ref="id18"/>
			<label kind="guard" x="204" y="110">maxgrade2()</label>
			<label kind="synchronisation" x="280" y="127">endrecov?</label>
		</transition>
		<transition>
			<source ref="id23"/>
			<target ref="id21"/>
			<label kind="guard" x="399" y="-136">maxgrade0()</label>
			<label kind="synchronisation" x="323" y="-136">endrecov?</label>
			<nail x="535" y="-85"/>
		</transition>
		<transition>
			<source ref="id24"/>
			<target ref="id17"/>
			<label kind="guard" x="110" y="153">maxgrade3()</label>
			<label kind="synchronisation" x="195" y="153">endrecov?</label>
			<nail x="170" y="170"/>
		</transition>
		<transition>
			<source ref="id23"/>
			<target ref="id18"/>
			<label kind="guard" x="119" y="51">maxgrade2()</label>
			<label kind="synchronisation" x="51" y="51">endrecov?</label>
			<nail x="153" y="68"/>
		</transition>
		<transition>
			<source ref="id16"/>
			<target ref="id19"/>
			<label kind="guard" x="93" y="-76">maxgrade1()</label>
			<label kind="synchronisation" x="25" y="-76">endrecov?</label>
			<nail x="85" y="-59"/>
		</transition>
		<transition>
			<source ref="id24"/>
			<target ref="id21"/>
			<label kind="guard" x="459" y="-187">maxgrade0()</label>
			<label kind="synchronisation" x="382" y="-187">endrecov?</label>
			<nail x="595" y="-161"/>
		</transition>
		<transition>
			<source ref="id23"/>
			<target ref="id19"/>
			<label kind="guard" x="323" y="25">maxgrade1()</label>
			<label kind="synchronisation" x="246" y="8">endrecov?</label>
		</transition>
		<transition>
			<source ref="id17"/>
			<target ref="id24"/>
			<label kind="synchronisation" x="161" y="195">startrecov?</label>
		</transition>
		<transition>
			<source ref="id18"/>
			<target ref="id23"/>
			<label kind="synchronisation" x="144" y="85">startrecov?</label>
		</transition>
		<transition>
			<source ref="id17"/>
			<target ref="id11"/>
			<label kind="synchronisation" x="-161" y="195">stop?</label>
		</transition>
		<transition>
			<source ref="id18"/>
			<target ref="id12"/>
			<label kind="synchronisation" x="-153" y="85">stop?</label>
		</transition>
		<transition>
			<source ref="id19"/>
			<target ref="id13"/>
			<label kind="synchronisation" x="-153" y="-34">stop?</label>
		</transition>
		<transition>
			<source ref="id21"/>
			<target ref="id14"/>
			<label kind="synchronisation" x="-153" y="-170">stop?</label>
		</transition>
		<transition>
			<source ref="id16"/>
			<target ref="id21"/>
			<label kind="guard" x="144" y="-119">maxgrade0()</label>
			<label kind="synchronisation" x="110" y="-127">endrecov?</label>
		</transition>
		<transition>
			<source ref="id20"/>
			<target ref="id21"/>
			<label kind="synchronisation" x="-33" y="-297">endrecov?</label>
			<nail x="-42" y="-280"/>
		</transition>
		<transition>
			<source ref="id17"/>
			<target ref="id15"/>
		</transition>
		<transition>
			<source ref="id19"/>
			<target ref="id16"/>
			<label kind="synchronisation" x="51" y="-51">startrecov?</label>
		</transition>
		<transition>
			<source ref="id21"/>
			<target ref="id20"/>
			<label kind="synchronisation" x="25" y="-238">startrecov?</label>
		</transition>
		<transition>
			<source ref="id18"/>
			<target ref="id17"/>
			<label kind="synchronisation" x="-42" y="119">g3?</label>
		</transition>
		<transition>
			<source ref="id19"/>
			<target ref="id18"/>
			<label kind="synchronisation" x="-42" y="0">g2?</label>
		</transition>
		<transition>
			<source ref="id21"/>
			<target ref="id19"/>
			<label kind="synchronisation" x="-42" y="-119">g1?</label>
		</transition>
		<transition>
			<source ref="id22"/>
			<target ref="id21"/>
		</transition>
	</template>
	<template>
		<name x="5" y="5">Toxic</name>
		<parameter>const id_t id</parameter>
		<declaration>clock x; // clock for the periodic increase in grade of a toxic

</declaration>
		<location id="id25" x="484" y="357">
			<name x="459" y="365">FastRecov</name>
			<committed/>
		</location>
		<location id="id26" x="153" y="76">
			<committed/>
		</location>
		<location id="id27" x="-51" y="93">
			<name x="-34" y="102">Recovered</name>
		</location>
		<location id="id28" x="34" y="178">
			<name x="-17" y="144">NotRecovered</name>
		</location>
		<location id="id29" x="578" y="76">
			<name x="587" y="51">PreG1</name>
			<label kind="invariant" x="519" y="93">time&lt;=ub[id]</label>
		</location>
		<location id="id30" x="476" y="0">
			<name x="433" y="-34">PreG0</name>
			<label kind="invariant" x="416" y="8">time&lt;=ub[id]</label>
		</location>
		<location id="id31" x="612" y="-119">
			<name x="602" y="-153">Initial</name>
			<committed/>
		</location>
		<location id="id32" x="680" y="178">
			<name x="646" y="144">G3_and_4</name>
		</location>
		<location id="id33" x="153" y="297">
			<name x="144" y="306">SlowRecov</name>
			<committed/>
		</location>
		<location id="id34" x="170" y="-119">
			<urgent/>
		</location>
		<location id="id35" x="416" y="178">
			<name x="433" y="161">G2</name>
			<label kind="invariant" x="399" y="144">x&lt;=per[id]</label>
		</location>
		<location id="id36" x="153" y="178">
			<name x="170" y="161">G1</name>
			<label kind="invariant" x="102" y="195">x&lt;=per[id]</label>
		</location>
		<location id="id37" x="297" y="0">
			<name x="287" y="-34">G0</name>
		</location>
		<location id="id38" x="0" y="0">
			<name x="-25" y="17">Postrecov</name>
			<label kind="invariant" x="-25" y="-34">time&lt;=ub[id]</label>
		</location>
		<location id="id39" x="263" y="76">
			<committed/>
		</location>
		<branchpoint id="id40" x="110" y="357">
		</branchpoint>
		<branchpoint id="id41" x="612" y="-25">
		</branchpoint>
		<branchpoint id="id42" x="34" y="297">
		</branchpoint>
		<branchpoint id="id43" x="153" y="0">
		</branchpoint>
		<init ref="id31"/>
		<transition>
			<source ref="id39"/>
			<target ref="id25"/>
			<label kind="guard" x="314" y="110">recovery &amp;&amp;
cycle&lt;=1</label>
		</transition>
		<transition>
			<source ref="id39"/>
			<target ref="id33"/>
			<label kind="guard" x="212" y="119">recovery &amp;&amp; 
cycle&gt;1</label>
		</transition>
		<transition>
			<source ref="id39"/>
			<target ref="id36"/>
			<label kind="guard" x="144" y="110">!recovery</label>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id40"/>
		</transition>
		<transition>
			<source ref="id40"/>
			<target ref="id28"/>
			<label kind="assignment" x="59" y="314">g[id]=1</label>
			<label kind="probability" x="119" y="323">6</label>
			<nail x="110" y="348"/>
			<nail x="110" y="229"/>
		</transition>
		<transition>
			<source ref="id40"/>
			<target ref="id27"/>
			<label kind="assignment" x="-126" y="340">g[id]=0</label>
			<label kind="probability" x="34" y="357">4</label>
			<nail x="-144" y="357"/>
			<nail x="-144" y="357"/>
			<nail x="-144" y="93"/>
		</transition>
		<transition>
			<source ref="id36"/>
			<target ref="id25"/>
			<label kind="guard" x="297" y="289">cycle&lt;=1</label>
			<label kind="synchronisation" x="323" y="314">startrecov?</label>
		</transition>
		<transition>
			<source ref="id35"/>
			<target ref="id25"/>
			<label kind="guard" x="459" y="263">cycle&lt;=1</label>
			<label kind="synchronisation" x="459" y="272">startrecov?</label>
		</transition>
		<transition>
			<source ref="id32"/>
			<target ref="id25"/>
			<label kind="guard" x="595" y="246">cycle&lt;=1</label>
			<label kind="synchronisation" x="578" y="263">startrecov?</label>
		</transition>
		<transition>
			<source ref="id26"/>
			<target ref="id39"/>
			<label kind="synchronisation" x="187" y="76">g1!</label>
		</transition>
		<transition>
			<source ref="id27"/>
			<target ref="id34"/>
			<label kind="synchronisation" x="-33" y="-136">endrecov?</label>
			<nail x="-51" y="-119"/>
		</transition>
		<transition>
			<source ref="id42"/>
			<target ref="id27"/>
			<label kind="assignment" x="-110" y="263">g[id]=0,
rec[id]++</label>
			<label kind="probability" x="-76" y="297">c[g[id]][rec[id]]</label>
			<nail x="-51" y="297"/>
		</transition>
		<transition>
			<source ref="id28"/>
			<target ref="id36"/>
			<label kind="synchronisation" x="59" y="161">endrecov?</label>
			<label kind="assignment" x="59" y="178">x=0, rr[id]=3</label>
		</transition>
		<transition>
			<source ref="id30"/>
			<target ref="id31"/>
			<label kind="synchronisation" x="494" y="-136">reset?</label>
			<label kind="assignment" x="494" y="-119">notox[id]=0</label>
			<nail x="476" y="-119"/>
		</transition>
		<transition>
			<source ref="id29"/>
			<target ref="id39"/>
			<label kind="guard" x="442" y="59">time&gt;=lb[id]</label>
			<label kind="synchronisation" x="374" y="59">g1!</label>
			<label kind="assignment" x="357" y="85">x=0, g[id]=1, n[id]++</label>
		</transition>
		<transition>
			<source ref="id30"/>
			<target ref="id37"/>
			<label kind="guard" x="348" y="-25">time&gt;=lb[id]</label>
		</transition>
		<transition>
			<source ref="id41"/>
			<target ref="id29"/>
			<label kind="probability" x="603" y="8">p[n[id]][id]</label>
		</transition>
		<transition>
			<source ref="id41"/>
			<target ref="id30"/>
			<label kind="assignment" x="501" y="-8">notox[id]=1</label>
			<label kind="probability" x="493" y="-42">1000-p[n[id]][id]</label>
		</transition>
		<transition>
			<source ref="id31"/>
			<target ref="id41"/>
		</transition>
		<transition>
			<source ref="id33"/>
			<target ref="id42"/>
		</transition>
		<transition>
			<source ref="id32"/>
			<target ref="id33"/>
			<label kind="guard" x="535" y="204">cycle&gt;1</label>
			<label kind="synchronisation" x="476" y="221">startrecov?</label>
		</transition>
		<transition>
			<source ref="id35"/>
			<target ref="id33"/>
			<label kind="guard" x="323" y="212">cycle&gt;1</label>
			<label kind="synchronisation" x="289" y="229">startrecov?</label>
		</transition>
		<transition>
			<source ref="id36"/>
			<target ref="id33"/>
			<label kind="guard" x="136" y="212">cycle&gt;1</label>
			<label kind="synchronisation" x="136" y="229">startrecov?</label>
		</transition>
		<transition>
			<source ref="id42"/>
			<target ref="id28"/>
			<label kind="assignment" x="34" y="246">g[id]=1,
rec[id]++</label>
			<label kind="probability" x="-25" y="221">10-c[g[id]][rec[id]]</label>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id37"/>
			<label kind="guard" x="212" y="-93">time&gt;=ub[id]</label>
			<nail x="238" y="-51"/>
			<nail x="238" y="-51"/>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id38"/>
			<label kind="guard" x="25" y="-93">time&lt;ub[id]</label>
		</transition>
		<transition>
			<source ref="id35"/>
			<target ref="id32"/>
			<label kind="guard" x="518" y="153">x&gt;=per[id]</label>
			<label kind="synchronisation" x="552" y="178">g3!</label>
			<label kind="assignment" x="501" y="178">g[id]=3</label>
		</transition>
		<transition>
			<source ref="id36"/>
			<target ref="id35"/>
			<label kind="guard" x="289" y="161">x&gt;=per[id]</label>
			<label kind="synchronisation" x="221" y="178">g2!</label>
			<label kind="assignment" x="255" y="161">x=0,
g[id]=2</label>
		</transition>
		<transition>
			<source ref="id43"/>
			<target ref="id26"/>
			<label kind="assignment" x="161" y="8">x=0,
g[id]=1,
n[id]++</label>
			<label kind="probability" x="85" y="25">p[n[id]][id]</label>
		</transition>
		<transition>
			<source ref="id43"/>
			<target ref="id37"/>
			<label kind="probability" x="161" y="-17">1000-p[n[id]][id]</label>
		</transition>
		<transition>
			<source ref="id38"/>
			<target ref="id43"/>
		</transition>
	</template>
	<template>
		<name>Test</name>
		<parameter>const id_t id</parameter>
		<location id="id44" x="-577" y="-60">
			<name x="-628" y="-69">Start</name>
		</location>
		<location id="id45" x="-416" y="-136">
			<name x="-441" y="-170">Lab_abn</name>
			<urgent/>
		</location>
		<location id="id46" x="-416" y="17">
			<name x="-442" y="34">Lab_norm</name>
			<urgent/>
		</location>
		<location id="id47" x="-280" y="-212">
			<name x="-272" y="-238">Diagnosis_NO_tox</name>
			<urgent/>
		</location>
		<location id="id48" x="-280" y="-76">
			<name x="-272" y="-68">Diagnosis_tox</name>
			<urgent/>
		</location>
		<location id="id49" x="-509" y="-60">
			<urgent/>
		</location>
		<branchpoint id="id50" x="-365" y="-136">
		</branchpoint>
		<branchpoint id="id51" x="-475" y="-60">
		</branchpoint>
		<init ref="id44"/>
		<transition>
			<source ref="id49"/>
			<target ref="id51"/>
		</transition>
		<transition>
			<source ref="id44"/>
			<target ref="id49"/>
			<label kind="synchronisation" x="-560" y="-85">test?</label>
		</transition>
		<transition>
			<source ref="id46"/>
			<target ref="id44"/>
			<label kind="assignment" x="-526" y="-9">r[id]=0</label>
			<nail x="-577" y="17"/>
		</transition>
		<transition>
			<source ref="id48"/>
			<target ref="id44"/>
			<label kind="assignment" x="-425" y="-306">r[id] = g[id],
rr[id]++</label>
			<nail x="-144" y="-76"/>
			<nail x="-144" y="-255"/>
			<nail x="-577" y="-255"/>
		</transition>
		<transition>
			<source ref="id47"/>
			<target ref="id44"/>
			<label kind="assignment" x="-424" y="-238">r[id]=0</label>
			<nail x="-577" y="-212"/>
		</transition>
		<transition>
			<source ref="id50"/>
			<target ref="id48"/>
			<label kind="probability" x="-322" y="-127">D_tox[g[id]][id]</label>
		</transition>
		<transition>
			<source ref="id50"/>
			<target ref="id47"/>
			<label kind="probability" x="-322" y="-178">100-D_tox[g[id]][id]</label>
		</transition>
		<transition>
			<source ref="id45"/>
			<target ref="id50"/>
		</transition>
		<transition>
			<source ref="id51"/>
			<target ref="id46"/>
			<label kind="probability" x="-441" y="-34">100-lab[g[id]][id]</label>
		</transition>
		<transition>
			<source ref="id51"/>
			<target ref="id45"/>
			<label kind="probability" x="-441" y="-102">lab[g[id]][id]</label>
		</transition>
	</template>
	<template>
		<name>Monitor</name>
		<declaration>bool notoxics() {
 //return (notox[0]==1 &amp;&amp; notox[1]==1 &amp;&amp; notox[2]==1 &amp;&amp; notox[3]==1 &amp;&amp; notox[4]==1 &amp;&amp; notox[5]==1 );
 return false;
}
</declaration>
		<location id="id52" x="-306" y="-17">
			<label kind="invariant" x="-382" y="-17">time&lt;=66</label>
		</location>
		<location id="id53" x="-221" y="-161">
		</location>
		<location id="id54" x="59" y="-34">
			<committed/>
		</location>
		<location id="id55" x="-178" y="-34">
			<label kind="invariant" x="-153" y="-42">time&lt;=66</label>
		</location>
		<init ref="id55"/>
		<transition>
			<source ref="id52"/>
			<target ref="id53"/>
			<label kind="guard" x="-340" y="-102">time&gt;=66</label>
		</transition>
		<transition>
			<source ref="id55"/>
			<target ref="id52"/>
			<label kind="synchronisation" x="-246" y="-51">stop?</label>
			<label kind="assignment" x="-272" y="-25">paltime=time</label>
		</transition>
		<transition>
			<source ref="id55"/>
			<target ref="id53"/>
			<label kind="guard" x="-204" y="-119">time&gt;=66</label>
			<label kind="assignment" x="-204" y="-136">paltime=time</label>
			<nail x="-195" y="-76"/>
		</transition>
		<transition>
			<source ref="id54"/>
			<target ref="id55"/>
			<nail x="-68" y="42"/>
		</transition>
		<transition>
			<source ref="id55"/>
			<target ref="id54"/>
			<label kind="guard" x="-76" y="-119">notoxics()</label>
			<label kind="synchronisation" x="-68" y="-85">reset!</label>
			<nail x="-51" y="-93"/>
		</transition>
	</template>
	<template>
		<name>ProgCheck</name>
		<declaration>







</declaration>
		<location id="id56" x="-1181" y="51">
			<name x="-1249" y="34">NoProg</name>
			<label kind="invariant" x="-1266" y="51">weeks&lt;=6</label>
		</location>
		<location id="id57" x="-1011" y="195">
			<name x="-994" y="187">Palliative</name>
		</location>
		<location id="id58" x="-1011" y="110">
			<committed/>
		</location>
		<location id="id59" x="-1011" y="-76">
			<name x="-1003" y="-127">Wait</name>
			<label kind="invariant" x="-994" y="-93">weeks&lt;=6</label>
		</location>
		<location id="id60" x="-1011" y="-153">
			<name x="-1021" y="-187">Start</name>
			<urgent/>
		</location>
		<branchpoint id="id61" x="-1011" y="51">
		</branchpoint>
		<init ref="id60"/>
		<transition>
			<source ref="id56"/>
			<target ref="id57"/>
			<label kind="synchronisation" x="-1122" y="127">stop?</label>
		</transition>
		<transition>
			<source ref="id56"/>
			<target ref="id59"/>
			<label kind="guard" x="-1181" y="-17">weeks&gt;=6</label>
			<label kind="assignment" x="-1122" y="-68">weeks=0,
cycle++</label>
		</transition>
		<transition>
			<source ref="id59"/>
			<target ref="id57"/>
			<label kind="synchronisation" x="-900" y="110">stop?</label>
			<nail x="-841" y="51"/>
		</transition>
		<transition>
			<source ref="id58"/>
			<target ref="id57"/>
			<label kind="synchronisation" x="-1011" y="127">stop!</label>
		</transition>
		<transition>
			<source ref="id61"/>
			<target ref="id56"/>
			<label kind="probability" x="-1139" y="25">1000-prog[cycle]</label>
		</transition>
		<transition>
			<source ref="id61"/>
			<target ref="id58"/>
			<label kind="probability" x="-1003" y="59">prog[cycle]</label>
		</transition>
		<transition>
			<source ref="id59"/>
			<target ref="id61"/>
			<label kind="guard" x="-1003" y="8">weeks&gt;=1</label>
		</transition>
		<transition>
			<source ref="id60"/>
			<target ref="id59"/>
		</transition>
	</template>
	<system>// Place template instantiations here.
//Process = Template();
// List one or more processes to be composed into a system.

system Protocol,Patient,Toxic,Test,Monitor,ProgCheck;
    </system>
	<queries>
		<query>
			<formula>simulate [&lt;=66;1000] {cycle, ProgCheck.NoProg, Protocol.Check} :1: (cycle &gt; 10)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>simulate [&lt;=66;1000] {cycle}
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=66](&lt;&gt;Protocol.Palliative)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=66](&lt;&gt; Patient.Problem)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[&lt;=66; 10000] (max: Patient.good)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=66](&lt;&gt;Patient.Palliative1)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[&lt;=66; 10000] (max: Protocol.Palliative)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[&lt;=66; 100000] (max: paltime)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>-
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[&lt;=66; 10000] (max: rr[0])
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[&lt;=66; 10000] (max: rr[1])
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[&lt;=66; 10000] (max: rr[2])
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[&lt;=66; 10000] (max: rr[3])
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[&lt;=66; 10000] (max: rr[4])
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[&lt;=66; 10000] (max: rr[5])
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>-
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=66] (&lt;&gt;Patient.Rec0)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=66] (&lt;&gt;Patient.Rec1)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=66] (&lt;&gt;Patient.Rec2)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=66] (&lt;&gt;Patient.Rec3)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[&lt;=66; 10000] (max: Patient.Rec3)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>-
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=66] (&lt;&gt;Patient.G1)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=66] (&lt;&gt;Patient.G2)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=66] (&lt;&gt;Patient.G3_and_4)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>-
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>-
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=66] (&lt;&gt;Patient.Problem)
			</formula>
			<comment>
			</comment>
		</query>
	</queries>
</nta>
